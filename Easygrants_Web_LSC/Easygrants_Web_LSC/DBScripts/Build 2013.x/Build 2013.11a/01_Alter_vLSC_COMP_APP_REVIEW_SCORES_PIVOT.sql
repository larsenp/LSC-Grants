ALTER VIEW [dbo].[vLSC_COMP_APP_REVIEW_SCORES_PIVOT]
AS

select wf_task_assignment_id,
	[PA1C1Q1],
	[PA1C1Q2],
	[PA1C1Q3],
	[PA1C1Q4],
	[PA1C1Q5],
	[PA1C1Q6],
	[PA1C1Q7],
	[PA1C1Q8],
	[PA1C1QF1],
	[PA1C1QF2],
	[PA1C2Q1],
	[PA1C2QF3],
	[PA1C2Q2],
	[PA1C2Q3],
	[PA1C4Q1],
	[PA1C4Q2],
	[PA1C4Q3],
	[PA1C4Q4],
	[PA1C4Q5],
	[PA2C1Q1],
	[PA2C1QF4],
	[PA2C1Q10],
	[PA2C1Q11a],
	[PA2C1Q11b],
	[PA2C1Q11c],
	[PA2C1Q11d],
	[PA2C1Q11e],
	[PA2C1Q11f],
	[PA2C1Q11g],
	[PA2C1Q11h],
	[PA2C1Q2],
	[PA2C1Q3],
	[PA2C1Q4],
	[PA2C1Q5],
	[PA2C1Q6],
	[PA2C1Q7],
	[PA2C1Q8],
	[PA2C1Q9],
	[PA2C1QF1],
	[PA2C1QF3],
	[PA2C2 and 3Q1],
	[PA2C2 and 3Q2],
	[PA2C2 and 3Q3],
	[PA2C2 and 3Q4],
	[PA2C2 and 3Q5],
	[PA2C2 and 3QF5],
	[PA2C2 and 3Q6],
	[PA2C2 and 3QF2],
	[PA2C2 and 3QF4],
	[PA3C1aQ1],
	[PA3C1aQ2],
	[PA3C1aQ3],
	[PA3C1aQF3],
	[PA3C1aQF5],
	[PA3C1aQF6],
	[PA3C1bQ1],
	[PA3C1bQ2],
	[PA3C1bQ3],
	[PA3C1bQ4],
	[PA3C1bQ5],
	[PA3C1bQ6],
	[PA3C1bQ7],
	[PA3C1bQF4],
	[PA3C1bQF5],
	[PA3C1bQF6],
	[PA3C1bQF7],
	[PA3C1bQF8],
	[PA3C1bQF9],
	[PA3C1cQ1],
	[PA3C1cQF10],
	[PA3C1cQ2],
	[PA3C1cQ3],
	[PA3C2Q1],
	[PA3C2Q10],
	[PA3C2Q2],
	[PA3C2Q3],
	[PA3C2Q4],
	[PA3C2Q5],
	[PA3C2Q6],
	[PA3C2Q7],
	[PA3C2Q8],
	[PA3C2Q9],
	[PA3C2QF10],
	[PA3C2QF11],
	[PA3C2QF12],
	[PA3C2QF13],
	[PA3C2QF14],
	[PA3C2QF7],
	[PA3C2QF8],
	[PA3C2QF9],
	[PA3C3Q1],
	[PA3C3Q2],
	[PA3C3Q3],
	[PA3C3Q4],
	[PA3C3Q5],
	[PA3C4Q1],
	[PA3C4Q2],
	[PA3C4Q3],
	[PA3C4QF15],
	[PA4C1Q1],
	[PA4C1Q2],
	[PA4C1Q3],
	[PA4C1Q4],
	[PA4C1Q5],
	[PA4C1Q6],
	[PA4C1QF10],
	[PA4C1QF12],
	[PA4C1QF16],
	[PA4C2Q1],
	[PA4C2Q2],
	[PA4C2Q3],
	[PA4C2Q4],
	[PA4C2Q5],
	[PA4C3Q1],
	[PA4C3Q2],
	[PA4C3Q3],
	[PA4C3Q4],
	[PA4C3Q5],
	[PA4C3Q6],
	[PA4C3QF13],
	[PA4C3QF17],
	[PA4C4Q1],
	[PA4C4Q2],
	[PA4C4Q3],
	[PA4C4Q4],
	[PA4C4Q5],
	[PA4C4Q6],
	[PA4C5Q1],
	[PA4C5Q2],
	[PA4C5Q3],
	[PA4C6Q1],
	[PA4C7Q1],
	[PA4C7Q2],
	[PA4C7Q3],
	[PA4C9Q1],
	[PA4C9Q2],
	[PA4C9Q3],
	[PA4C9Q4],
	[PA4C9QF18]
	FROM
		(select wfta.wf_task_assignment_id,
			'PA' + CAST(pa.sort_order AS VARCHAR(2)) + 'C' + rc.abbr +'Q' + ri.abbr inq, 
			ris.value score
			from LSC_REVIEW_ASSIGNMENT_INQUIRY rai
				join LSC_a_REVIEW_INQUIRY ri on rai.lsc_review_inquiry_id = ri.id
				join LSC_a_REVIEW_CRITERION rc on ri.lsc_review_criterion_id = rc.id
				join LSC_a_REVIEW_PERFORMANCE_AREA pa on rc.lsc_review_performance_area_id = pa.id
				join LSC_c_REVIEW_INQUIRY_SCORE ris on rai.lsc_review_inquiry_score_id = ris.id
				join WF_TASK_ASSIGNMENT wfta on rai.wf_task_assignment_id = wfta.wf_task_assignment_id) as score
	PIVOT
		(SUM(score) 
			FOR inq IN ([PA1C1Q1],
				[PA1C1Q2],
				[PA1C1Q3],
				[PA1C1Q4],
				[PA1C1Q5],
				[PA1C1Q6],
				[PA1C1Q7],
				[PA1C1Q8],
				[PA1C1QF1],
				[PA1C1QF2],
				[PA1C2Q1],
				[PA1C2QF3],
				[PA1C2Q2],
				[PA1C2Q3],
				[PA1C4Q1],
				[PA1C4Q2],
				[PA1C4Q3],
				[PA1C4Q4],
				[PA1C4Q5],
				[PA2C1Q1],
				[PA2C1QF4],
				[PA2C1Q10],
				[PA2C1Q11a],
				[PA2C1Q11b],
				[PA2C1Q11c],
				[PA2C1Q11d],
				[PA2C1Q11e],
				[PA2C1Q11f],
				[PA2C1Q11g],
				[PA2C1Q11h],
				[PA2C1Q2],
				[PA2C1Q3],
				[PA2C1Q4],
				[PA2C1Q5],
				[PA2C1Q6],
				[PA2C1Q7],
				[PA2C1Q8],
				[PA2C1Q9],
				[PA2C1QF1],
				[PA2C1QF3],
				[PA2C2 and 3Q1],
				[PA2C2 and 3Q2],
				[PA2C2 and 3Q3],
				[PA2C2 and 3Q4],
				[PA2C2 and 3Q5],
				[PA2C2 and 3QF5],
				[PA2C2 and 3Q6],
				[PA2C2 and 3QF2],
				[PA2C2 and 3QF4],
				[PA3C1aQ1],
				[PA3C1aQ2],
				[PA3C1aQ3],
				[PA3C1aQF3],
				[PA3C1aQF5],
				[PA3C1aQF6],
				[PA3C1bQ1],
				[PA3C1bQ2],
				[PA3C1bQ3],
				[PA3C1bQ4],
				[PA3C1bQ5],
				[PA3C1bQ6],
				[PA3C1bQ7],
				[PA3C1bQF4],
				[PA3C1bQF5],
				[PA3C1bQF6],
				[PA3C1bQF7],
				[PA3C1bQF8],
				[PA3C1bQF9],
				[PA3C1cQ1],
				[PA3C1cQF10],
				[PA3C1cQ2],
				[PA3C1cQ3],
				[PA3C2Q1],
				[PA3C2Q10],
				[PA3C2Q2],
				[PA3C2Q3],
				[PA3C2Q4],
				[PA3C2Q5],
				[PA3C2Q6],
				[PA3C2Q7],
				[PA3C2Q8],
				[PA3C2Q9],
				[PA3C2QF10],
				[PA3C2QF11],
				[PA3C2QF12],
				[PA3C2QF13],
				[PA3C2QF14],
				[PA3C2QF7],
				[PA3C2QF8],
				[PA3C2QF9],
				[PA3C3Q1],
				[PA3C3Q2],
				[PA3C3Q3],
				[PA3C3Q4],
				[PA3C3Q5],
				[PA3C4Q1],
				[PA3C4Q2],
				[PA3C4Q3],
				[PA3C4QF15],
				[PA4C1Q1],
				[PA4C1Q2],
				[PA4C1Q3],
				[PA4C1Q4],
				[PA4C1Q5],
				[PA4C1Q6],
				[PA4C1QF10],
				[PA4C1QF12],
				[PA4C1QF16],
				[PA4C2Q1],
				[PA4C2Q2],
				[PA4C2Q3],
				[PA4C2Q4],
				[PA4C2Q5],
				[PA4C3Q1],
				[PA4C3Q2],
				[PA4C3Q3],
				[PA4C3Q4],
				[PA4C3Q5],
				[PA4C3Q6],
				[PA4C3QF13],
				[PA4C3QF17],
				[PA4C4Q1],
				[PA4C4Q2],
				[PA4C4Q3],
				[PA4C4Q4],
				[PA4C4Q5],
				[PA4C4Q6],
				[PA4C5Q1],
				[PA4C5Q2],
				[PA4C5Q3],
				[PA4C6Q1],
				[PA4C7Q1],
				[PA4C7Q2],
				[PA4C7Q3],
				[PA4C9Q1],
				[PA4C9Q2],
				[PA4C9Q3],
				[PA4C9Q4],
				[PA4C9QF18]
			)) AS piv
